!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClearColorByValue=t.GetRotateZ=t.GetRotateY=t.GetRotateX=t.GetTranslation=t.GetProjection=t.LoadJSON=t.LoadBin=t.LoadImage=t.CreateFrameBuffer=t.CreateEmptyTexture2D=t.CreateTexture2D=t.CreateBuffer=t.CreateProgram=t.ParseError=t.GetElementById=void 0,t.GetElementById=function(e){return document.getElementById(e)},t.ParseError=function(e){return"string"==typeof e?e:e instanceof Error?e.message:"Unknown Error"},t.CreateProgram=function(e,t,r){var n=e.createShader(e.VERTEX_SHADER);if(!n)throw new Error("创建vertexshader时出错");if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error("vertexshader编译出错:"+i)}var o=e.createShader(e.FRAGMENT_SHADER);if(!o)throw new Error("创建fragShader时出错");if(e.shaderSource(o,r),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){i=e.getShaderInfoLog(o);throw e.deleteShader(n),e.deleteShader(o),new Error("fragShader编译出错:"+i)}var a=e.createProgram();if(!a)throw new Error("创建program时出错");if(e.attachShader(a,n),e.attachShader(a,o),e.linkProgram(a),e.deleteShader(n),e.deleteShader(o),!e.getProgramParameter(a,e.LINK_STATUS)){i=e.getProgramInfoLog(a);throw e.deleteProgram(a),new Error("program链接出错:"+i)}return a},t.CreateBuffer=function(e){var t=e.createBuffer();if(t)return t;throw new Error("创建buffer时出错")},t.CreateTexture2D=function(e,t){var r=e.createTexture();if(r)return e.bindTexture(e.TEXTURE_2D,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),r;throw new Error("创建texture时出错")},t.CreateEmptyTexture2D=function(e){var t=e.createTexture();if(t)return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.canvas.width,e.canvas.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),t;throw new Error("创建texture时出错")},t.CreateFrameBuffer=function(e){var t=e.createFramebuffer();if(t)return t;throw new Error("创建framebuffer时出错")},t.LoadImage=function(e){return new Promise((function(t){var r=new Image;r.onload=t.bind(null,r),r.src=e}))},t.LoadBin=function(e){return new Promise((function(t){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="arraybuffer",r.onload=function(){return t(r.response)},r.send()}))},t.LoadJSON=function(e){return new Promise((function(t){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="json",r.onload=function(){return t(r.response)},r.send()}))},t.GetProjection=function(e,t,r,n){var i=Math.tan(e*Math.PI/360);return[1/i/2,0,0,0,0,t/i/2,0,0,0,0,-(n+r)/(n-r),-1,0,0,-2*n*r/(n-r),0]},t.GetTranslation=function(e,t,r){return[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1]},t.GetRotateX=function(e){var t=Math.cos(e/180*Math.PI),r=Math.sin(e/180*Math.PI);return[1,0,0,0,0,t,r,0,0,-r,t,0,0,0,0,1]},t.GetRotateY=function(e){var t=Math.cos(e/180*Math.PI),r=Math.sin(e/180*Math.PI);return[t,0,-r,0,0,1,0,0,r,0,t,0,0,0,0,1]},t.GetRotateZ=function(e){var t=Math.cos(e/180*Math.PI),r=Math.sin(e/180*Math.PI);return[t,r,0,0,-r,t,0,0,0,0,1,0,0,0,0,1]},t.ClearColorByValue=function(e,t){var r=0,n=0,i=0,o=t%1;switch(Math.floor(t%6)){case 0:r=1,i=1-o;break;case 1:r=1,n=o;break;case 2:r=1-o,n=1;break;case 3:n=1,i=o;break;case 4:n=1-o,i=1;break;case 5:r=o,i=1}e.clearColor(r,n,i,1),e.clear(e.COLOR_BUFFER_BIT)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLHandler=void 0;var n=function(){};t.GLHandler=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(21);var n=r(0),i=r(3);window.addEventListener("error",(function(e){alert(n.ParseError(e.error))}));var o=n.GetElementById("title-container"),a=n.GetElementById("canvas");new i.GLHandlerManager(o,a)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLHandlerManager=void 0;var n=r(4),i=r(7),o=r(8),a=r(13),u=r(18),s=function(){function e(e,t){var r=this;this.canvas=t,this.curIndex=-1;var s=t.getContext("webgl",{stencil:!0});if(!s)throw new Error("无法获取到webgl上下文");this.gl=s,this.handlers=[new i.ClearColor,new n.ProceduralTexture,new o.Mask,new a.Model,new u.RenderTexture],this.titles=this.handlers.map((function(t,n){var i=document.createElement("button");return t.test&&!t.test(s)?i.disabled=!0:t.load?(i.disabled=!0,t.load().then((function(){i.disabled=!1}))):i.disabled=!1,i.innerText=t.title,i.onclick=function(){r.setActiveIndex(n)},e.appendChild(i),i})),this.setActiveIndex(0)}return e.prototype.setActiveIndex=function(e){if(this.curIndex!==e){this.curIndex>=0&&(this.handlers[this.curIndex].leave(),this.titles[this.curIndex].removeAttribute("select"),this.canvas.onmousemove=null,this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseover=null,this.canvas.onmouseout=null),this.titles[e].setAttribute("select","");var t=this.handlers[e];t.onmousemove&&(this.canvas.onmousemove=function(e){t.onmousemove(e.offsetX,e.offsetY)}),t.onmousedown&&(this.canvas.onmousedown=function(e){t.onmousedown(e.offsetX,e.offsetY)}),t.onmouseup&&(this.canvas.onmouseup=function(e){t.onmouseup(e.offsetX,e.offsetY)}),t.onmouseover&&(this.canvas.onmouseover=function(e){t.onmouseover(e.offsetX,e.offsetY)}),t.onmouseout&&(this.canvas.onmouseout=function(e){t.onmouseout(e.offsetX,e.offsetY)}),t.enter(this.gl),this.curIndex=e}},e}();t.GLHandlerManager=s},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProceduralTexture=void 0;var a=o(r(5)),u=o(r(6)),s=r(1),l=r(0),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title="程序纹理",t.gl=null,t.program=null,t.vertexBuffer=null,t.positionIndex=0,t.renderId=null,t.timeLocation=null,t.startTime=0,t.mouseX=0,t.mouseY=0,t.mouseDirty=!1,t.mouseLocation=null,t.render=function(){var e=Date.now();t.gl.uniform1f(t.timeLocation,(e-t.startTime)/1e3),t.mouseDirty&&(t.gl.uniform2f(t.mouseLocation,t.mouseX,t.mouseY),t.mouseDirty=!1),t.gl.drawArrays(t.gl.TRIANGLES,0,6),t.renderId=requestAnimationFrame(t.render)},t}return i(t,e),t.prototype.enter=function(e){this.gl=e,this.program=l.CreateProgram(e,a.default,u.default),this.vertexBuffer=l.CreateBuffer(e),this.positionIndex=this.gl.getAttribLocation(this.program,"position"),e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Float32Array.of(-1,-1,1,-1,1,1,-1,-1,1,1,-1,1),e.STATIC_DRAW),e.enableVertexAttribArray(this.positionIndex),e.vertexAttribPointer(this.positionIndex,2,e.FLOAT,!1,8,0);var t=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform2f(t,this.gl.canvas.width,this.gl.canvas.height),this.timeLocation=this.gl.getUniformLocation(this.program,"u_time"),this.mouseLocation=this.gl.getUniformLocation(this.program,"u_mouse"),this.mouseX=this.mouseY=0,this.startTime=Date.now(),this.render()},t.prototype.onmousemove=function(e,t){this.mouseX=e,this.mouseY=t,this.mouseDirty=!0},t.prototype.onmouseover=function(e,t){this.mouseX=e,this.mouseY=t,this.mouseDirty=!0},t.prototype.leave=function(){null!==this.renderId&&(cancelAnimationFrame(this.renderId),this.renderId=null),this.gl.disableVertexAttribArray(this.positionIndex),this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.deleteBuffer(this.vertexBuffer),this.gl=null,this.program=null,this.vertexBuffer=null,this.timeLocation=null,this.mouseLocation=null},t}(s.GLHandler);t.ProceduralTexture=f},function(e,t){e.exports="attribute vec2 position;void main(){gl_Position=vec4(position,0.,1.);}"},function(e,t){e.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec2 u_resolution;uniform vec2 u_mouse;uniform float u_time;float A(vec2 B,vec2 C){return smoothstep(.4,.5,length(B-C));}void main(){vec2 B=gl_FragCoord.xy/vec2(50.,50.);vec2 D=mod(floor(B),2.)*2.-1.;vec2 C=vec2(.5,.5);vec2 E;B=fract(B);vec2 F=mod(floor(vec2(u_time)+vec2(0.,1.)),2.);vec2 G=D*F;C.y+=G.x*fract(u_time);E.y=C.y-G.x;C.x+=G.y*fract(u_time);E.x=C.x-G.y;float H=A(B,C);H*=A(B,E);gl_FragColor=vec4(vec3(H),1.);}"},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ClearColor=void 0;var o=r(1),a=r(0),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title="清屏",t.gl=null,t.renderId=null,t.startTime=0,t.render=function(){var e=(Date.now()-t.startTime)/1e3;a.ClearColorByValue(t.gl,e),t.renderId=requestAnimationFrame(t.render)},t}return i(t,e),t.prototype.enter=function(e){this.gl=e,this.startTime=Date.now(),this.render()},t.prototype.leave=function(){null!==this.renderId&&(cancelAnimationFrame(this.renderId),this.renderId=null),this.gl=null},t}(o.GLHandler);t.ClearColor=u},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}s((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Mask=void 0;var s=u(r(9)),l=u(r(10)),f=u(r(11)),c=u(r(12)),h=r(1),d=r(0),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title="遮罩",t.gl=null,t.water=null,t.waterProgram=null,t.maskProgram=null,t.waterTexture=null,t.waterBuffer=null,t.maskBuffer=null,t.waterP=0,t.maskP=0,t.waterUV=0,t.maskUV=0,t.enabled=[],t}return i(t,e),t.prototype.load=function(){return o(this,void 0,Promise,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return e=this,[4,d.LoadImage(s.default)];case 1:return e.water=t.sent(),[2]}}))}))},t.prototype.enter=function(e){this.gl=e,e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),this.waterProgram=d.CreateProgram(e,l.default,f.default),this.maskProgram=d.CreateProgram(e,l.default,c.default),e.activeTexture(e.TEXTURE0),this.waterTexture=d.CreateTexture2D(e,this.water),this.waterBuffer=d.CreateBuffer(e),this.maskBuffer=d.CreateBuffer(e),e.bindBuffer(e.ARRAY_BUFFER,this.waterBuffer),e.bufferData(e.ARRAY_BUFFER,Float32Array.of(-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,-1,0,0,1,1,1,1,-1,1,0,1),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.maskBuffer),e.bufferData(e.ARRAY_BUFFER,96,e.DYNAMIC_DRAW),this.waterP=e.getAttribLocation(this.waterProgram,"position"),this.maskP=e.getAttribLocation(this.maskProgram,"position"),this.waterUV=e.getAttribLocation(this.waterProgram,"uv"),this.maskUV=e.getAttribLocation(this.maskProgram,"uv");var t=e.getUniformLocation(this.waterProgram,"tex");e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.waterTexture),e.useProgram(this.waterProgram),e.uniform1i(t,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.enable(e.STENCIL_TEST),this.render(.5,.5)},t.prototype.render=function(e,t){e=2*e-1,t=1-2*t,this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.colorMask(!1,!1,!1,!1),this.gl.stencilFunc(this.gl.ALWAYS,1,255),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.maskBuffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,Float32Array.of(e-.1,t-.1,0,1,e+.1,t-.1,1,1,e+.1,t+.1,1,0,e-.1,t-.1,0,1,e+.1,t+.1,1,0,e-.1,t+.1,0,0)),this.gl.useProgram(this.maskProgram),this.enable([this.maskP,this.maskUV]),this.gl.vertexAttribPointer(this.maskP,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(this.maskUV,2,this.gl.FLOAT,!1,16,8),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.colorMask(!0,!0,!0,!0),this.gl.stencilFunc(this.gl.EQUAL,1,255),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.waterBuffer),this.gl.useProgram(this.waterProgram),this.enable([this.waterP,this.waterUV]),this.gl.vertexAttribPointer(this.waterP,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(this.waterUV,2,this.gl.FLOAT,!1,16,8),this.gl.drawArrays(this.gl.TRIANGLES,0,6)},t.prototype.onmouseover=function(e,t){this.render(e/this.gl.canvas.width,t/this.gl.canvas.height)},t.prototype.onmousemove=function(e,t){this.render(e/this.gl.canvas.width,t/this.gl.canvas.height)},t.prototype.leave=function(){this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP),this.gl.disable(this.gl.STENCIL_TEST),this.gl.useProgram(null),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.deleteProgram(this.waterProgram),this.gl.deleteProgram(this.maskProgram),this.gl.deleteTexture(this.waterTexture),this.gl.deleteBuffer(this.waterBuffer),this.gl.deleteBuffer(this.maskBuffer),this.enable([]),this.gl=null,this.waterProgram=null,this.maskProgram=null,this.waterTexture=null},t.prototype.enable=function(e){var t=this,r=e.filter((function(e){return t.enabled.indexOf(e)<0})),n=this.enabled.filter((function(t){return e.indexOf(t)<0}));r.forEach((function(e){return t.gl.enableVertexAttribArray(e)})),n.forEach((function(e){return t.gl.disableVertexAttribArray(e)})),this.enabled=e},t}(h.GLHandler);t.Mask=g},function(e,t,r){"use strict";r.r(t),t.default=r.p+"ff479dcd247dcc4ede764ed109967425.jpg"},function(e,t){e.exports="attribute vec2 position;attribute vec2 uv;varying vec2 texcoord;void main(){texcoord=uv;gl_Position=vec4(position,0.,1.);}"},function(e,t){e.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 texcoord;uniform sampler2D tex;void main(){gl_FragColor=texture2D(tex,texcoord);}"},function(e,t){e.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 texcoord;void main(){float A=distance(texcoord,vec2(.5,.5));if(A>.5){discard;}gl_FragColor=vec4(1.,1.,1.,1.);}"},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}s((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var a=o(r(14)),u=o(r(15)),s=o(r(16)),l=o(r(17)),f=r(0),c=function(){function e(){var e=this;this.title="模型",this.gl=null,this.dragonImage=null,this.dragonTexture=null,this.vertice=null,this.verticeBuffer=null,this.indice=null,this.indiceBuffer=null,this.program=null,this.positionIndex=0,this.uvIndex=0,this.mLocation=null,this.renderId=null,this.startTime=0,this.render=function(){e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT);var t=(Date.now()-e.startTime)/1e3*60;e.gl.uniformMatrix4fv(e.mLocation,!1,f.GetRotateY(t)),e.gl.drawElements(e.gl.TRIANGLES,e.indice.length,e.gl.UNSIGNED_INT,0),e.renderId=requestAnimationFrame(e.render)}}return e.prototype.load=function(){return n(this,void 0,Promise,(function(){var e,t,r,n,o,s,l,c;return i(this,(function(i){switch(i.label){case 0:return[4,Promise.all([f.LoadImage(a.default),f.LoadBin(u.default)])];case 1:for(e=i.sent(),t=e[0],r=e[1],this.dragonImage=t,n=new DataView(r),o=n.getUint32(0,!0),s=n.getUint32(4,!0),this.vertice=new Float32Array(o),this.indice=new Uint32Array(s),c=0;c<o;c++)this.vertice[c]=n.getFloat32(8+4*c,!0);for(l=8+4*o,c=0;c<s;c++)this.indice[c]=n.getUint32(l+4*c,!0);return[2]}}))}))},e.prototype.test=function(e){return!!e.getExtension("OES_element_index_uint")||(console.log("该浏览器不支持OES_element_index_uint拓展!"),!1)},e.prototype.enter=function(e){this.gl=e,this.verticeBuffer=f.CreateBuffer(e),e.bindBuffer(e.ARRAY_BUFFER,this.verticeBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertice,e.STATIC_DRAW),this.indiceBuffer=f.CreateBuffer(e),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indiceBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indice,e.STATIC_DRAW),this.program=f.CreateProgram(e,s.default,l.default),e.useProgram(this.program),e.activeTexture(e.TEXTURE0),this.dragonTexture=f.CreateTexture2D(e,this.dragonImage),e.bindTexture(e.TEXTURE_2D,this.dragonTexture),this.positionIndex=e.getAttribLocation(this.program,"position"),e.enableVertexAttribArray(this.positionIndex),e.vertexAttribPointer(this.positionIndex,3,e.FLOAT,!1,32,0),this.uvIndex=e.getAttribLocation(this.program,"uv"),e.enableVertexAttribArray(this.uvIndex),e.vertexAttribPointer(this.uvIndex,2,e.FLOAT,!1,32,24);var t=e.getUniformLocation(this.program,"tex");e.uniform1i(t,0),this.mLocation=e.getUniformLocation(this.program,"m");var r=e.getUniformLocation(this.program,"v"),n=f.GetTranslation(0,-4,-20);e.uniformMatrix4fv(r,!1,n);var i=e.getUniformLocation(this.program,"p"),o=f.GetProjection(40,e.canvas.width/e.canvas.height,1,100);return e.uniformMatrix4fv(i,!1,o),this.startTime=Date.now(),this.gl.clearColor(0,0,0,1),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),this.render(),!0},e.prototype.leave=function(){this.gl.disable(this.gl.CULL_FACE),this.gl.disable(this.gl.DEPTH_TEST),null!==this.renderId&&(cancelAnimationFrame(this.renderId),this.renderId=null),this.gl.disableVertexAttribArray(this.positionIndex),this.gl.disableVertexAttribArray(this.uvIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.deleteTexture(this.dragonTexture),this.dragonTexture=null,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.deleteBuffer(this.verticeBuffer),this.verticeBuffer=null,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.deleteBuffer(this.indiceBuffer),this.indiceBuffer=null,this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.mLocation=null,this.program=null,this.gl=null},e}();t.Model=c},function(e,t,r){"use strict";r.r(t),t.default=r.p+"76a8d2fd7a5b518d6d5d9c43e9cac6aa.png"},function(e,t,r){"use strict";r.r(t),t.default=r.p+"e25f105b55cbbe8fe155861c4c846f22.bin"},function(e,t){e.exports="attribute vec3 position;attribute vec2 uv;varying vec2 vUV;uniform mat4 m;uniform mat4 v;uniform mat4 p;void main(){vUV=uv;gl_Position=p*v*m*vec4(position,1.);}"},function(e,t){e.exports="precision mediump float;varying vec2 vUV;uniform sampler2D tex;void main(){gl_FragColor=texture2D(tex,vUV);}"},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderTexture=void 0;var a=o(r(19)),u=o(r(20)),s=r(1),l=r(0);function f(e,t){var r=l.CreateBuffer(e);return e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,Float32Array.from(t),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),r}function c(e,t){var r=e.getAttribLocation(t,"position");e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,16,0);var n=e.getAttribLocation(t,"uv");e.enableVertexAttribArray(n),e.vertexAttribPointer(n,2,e.FLOAT,!1,16,8)}var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title="渲染纹理",t.gl=null,t.program=null,t.verticeBuffer=null,t.verticeBuffer2=null,t.texture=null,t.texture2=null,t.value=0,t.frameBuffer=null,t.isTexutre=!0,t.id=null,t.render=function(){var e,r;t.value+=.25,t.isTexutre?(e=t.texture,r=t.texture2):(r=t.texture,e=t.texture2),t.isTexutre=!t.isTexutre,t.gl.bindFramebuffer(t.gl.FRAMEBUFFER,t.frameBuffer),t.gl.framebufferTexture2D(t.gl.FRAMEBUFFER,t.gl.COLOR_ATTACHMENT0,t.gl.TEXTURE_2D,r,0),l.ClearColorByValue(t.gl,t.value),t.gl.bindTexture(t.gl.TEXTURE_2D,e);var n=t.gl.getUniformLocation(t.program,"tex");t.gl.uniform1i(n,0),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,t.verticeBuffer2),c(t.gl,t.program),t.gl.drawArrays(t.gl.TRIANGLES,0,6),t.gl.bindFramebuffer(t.gl.FRAMEBUFFER,null),t.gl.bindTexture(t.gl.TEXTURE_2D,r),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,t.verticeBuffer),c(t.gl,t.program),t.gl.drawArrays(t.gl.TRIANGLES,0,6),t.id=setTimeout(t.render,1e3)},t}return i(t,e),t.prototype.enter=function(e){this.gl=e,this.value=0,this.program=l.CreateProgram(e,a.default,u.default),this.verticeBuffer=f(e,[-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,-1,0,0,1,1,1,1,-1,1,0,1]),this.verticeBuffer2=f(e,[-.9,-1,0,0,1,-.9,1,0,.9,1,1,1,-.9,-1,0,0,.9,1,1,1,-1,.9,0,1]);var t=e.getUniformLocation(this.program,"tex");this.texture=l.CreateEmptyTexture2D(e),this.texture2=l.CreateEmptyTexture2D(e),e.activeTexture(e.TEXTURE0),e.useProgram(this.program),e.uniform1i(t,0),this.frameBuffer=l.CreateFrameBuffer(e),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0),l.ClearColorByValue(e,this.value),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,this.texture),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.verticeBuffer),c(e,this.program),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.isTexutre=!0,this.id=setTimeout(this.render,1e3)},t.prototype.leave=function(){null!==this.id&&(clearTimeout(this.id),this.id=null),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.deleteFramebuffer(this.frameBuffer),this.frameBuffer=null,this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.deleteTexture(this.texture),this.texture=null,this.gl.deleteTexture(this.texture2),this.texture2=null,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.deleteBuffer(this.verticeBuffer),this.verticeBuffer=null,this.gl.deleteBuffer(this.verticeBuffer2),this.verticeBuffer2=null,this.gl.deleteProgram(this.program),this.gl.useProgram(null),this.program=null,this.gl=null},t}(s.GLHandler);t.RenderTexture=h},function(e,t){e.exports="attribute vec2 position;attribute vec2 uv;varying vec2 texcoord;void main(){texcoord=uv;gl_Position=vec4(position,0.,1.);}"},function(e,t){e.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 texcoord;uniform sampler2D tex;void main(){gl_FragColor=texture2D(tex,texcoord);}"},function(e,t){}]);